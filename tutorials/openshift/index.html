---
layout: default
title:  Openshift deployment howto - Alf.io
categories: tutorial
---

<div class="page-header">
    <h1>How to deploy Alf.io on <a href="openshift.com" target="_blank">Openshift</a> (Wildfly 8.2+)</h1>
</div>
<ul class="list-unstyled">
    <li class="media">
        <div class="media-left">
            <a href="images/001.png" target="_blank"><img class="media-object"
                                                          srcset="images/001_mini.png 1x, images/001.png 2x"></a>
        </div>
        <div class="media-body">
            <h4 class="media-heading">Create new application</h4>
            <p>Click on <em>Add new application</em> on your openshift home</p>
        </div>
    </li>
    <li class="media">
        <div class="media-left">
            <a href="images/002.png" target="_blank"><img class="media-object"
                                                          srcset="images/002_mini.png 1x, images/002.png 2x"></a>
        </div>
        <div class="media-body">
            <h4 class="media-heading">Add application server cartridge</h4>
            <p>Use the search input text to find the application server named "Wildfly Application Server 8.2.0.Final"
                (or newer)</p>
        </div>
    </li>
    <li class="media">
        <div class="media-left">
            <a href="images/003.png" target="_blank"><img class="media-object"
                                                          srcset="images/003_mini.png 1x, images/003.png 2x"></a>
        </div>
        <div class="media-body">
            <h4 class="media-heading">Configure the Application Server</h4>
            <ul>
                <li>Define a public address for your application inserting the application name and selecting the domain
                    on the right. The final URL will look like "https://myapplication-mydomain.rhcloud.com"
                </li>
                <li>Select the gear size for your application</li>
                <li>Select scaling profile. We would suggest to select the "scale with web traffic" option</li>
            </ul>
        </div>
    </li>

<li class="media">
    <div class="media-left">
        <a href="images/004.png" target="_blank"><img class="media-object"
                                                      srcset="images/004_mini.png 1x, images/004.png 2x"></a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">Add a database cartridge</h4>
        <p>Click on <em>Add Postgresql 9.2</em> link in order to create a database cartridge. Please note that Alf.io
            supports only Postgresql</p>
    </div>
</li>
<li class="media">
    <div class="media-left">
        <a href="images/005.png" target="_blank"><img class="media-object"
                                                      srcset="images/005_mini.png 1x, images/005.png 2x"></a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">Save Postgres cartridge</h4>
        <p>Click on <em>Add Cartridge</em> link to create the cartridge</p>
    </div>
</li>
<li class="media">
    <div class="media-left">
        <a href="images/006.png" target="_blank"><img class="media-object"
                                                      srcset="images/006_mini.png 1x, images/006.png 2x"></a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">Restart your application</h4>
        <p>The application and the database cartridges have been successfully created but not yet linked each other. To
            do that, you must restart your application. Just click on <em>Restart Application</em>, as shown</p>
    </div>
</li>
<li class="media">
    <div class="media-left">
        <a href="images/007.png" target="_blank"><img class="media-object"
                                                      srcset="images/007_mini.png 1x, images/007.png 2x"></a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">Deploy Alf.io</h4>
        <p>before doing further steps, please ensure that you're already able to access your application remotely. You
            may need extra configuration, see <a href="https://developers.openshift.com/managing-your-applications/remote-connection.html" target="_blank">official reference</a></p>
        <ul>
            <li>download the latest alfio.war from <a href="https://github.com/exteso/alf.io/releases/latest" target="_blank">GitHub</a> under <i>/tmp</i></li>
            <li>clone the application repository locally: <br>
                <code>git clone ssh://<i>insert-repo-url-here</i>/</code></li>
            <li>Delete unnecessary files: <br/>
                <code>cd <i>application</i></code><br/>
                <code>git rm -rf pom.xml README.md src</code><br/>
            </li>
            <li>copy alf.io war: <br>
                <code>cp /tmp/alfio-<i>version</i>.war deployments/ROOT.war</code></li>
            <li>commit the modifications:<br/>
                <code>git commit -m "Look ma! I just installed alf.io!"</code><br>
            </li>
            <li>
                Limit the number of threads created by activemq/artemis (see <a href="https://developer.jboss.org/thread/268397" target="_blank">forum</a> and <a href="https://issues.jboss.org/browse/JBEAP-2947" target="_blank">issue</a>) and increase the memory reserved to the application<br>
                <code>rhc set-env JAVA_OPTS_EXT="-Dactivemq.artemis.client.global.thread.pool.max.size=20 -Xmx384m" -n <i>mydomain</i> -a <i>myapplication</i></code>
            </li>
            <li>
                Push the changes:<br>
                <code>git push</code>
            </li>
            <li>...and wait for the application to start</li>
        </ul>
    </div>
</li>

<li class="media">
    <div class="media-left">
        <a href="images/008.png" target="_blank"><img class="media-object"
                                                      srcset="images/008_mini.png 1x, images/008.png 2x"></a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">Retrieve admin password</h4>
        <p>check the log <code>rhc tail -n <i>mydomain</i> -a <i>myapplication</i> -f wildfly/logs/alfio.log</code> and find the auto-generated password. Then you can
            access the admin under <code>https://appname-yourdomain.rhcloud.com/admin/</code></p>
    </div>
</li>
</ul>
